CosmicExploration = {
    mission_ids = {
        [1] = "Multi-purpose Fiberboard",
        [2] = "Fieldwork Fuel",
        [3] = "Gathering Miscellany",
        [4] = "Essential Research Materials",
        [5] = "Charcoal Longevity Testing",
        [6] = "General-purpose Bedding",
        [7] = "Thin Fiberboard",
        [8] = "Carpentry Provisions",
        [9] = "Worker's Weaving Tools",
        [10] = "Data Entry Paper",
        [11] = "Interior Insulation Materials",
        [12] = "Cosmoliner Supplies",
        [13] = "New Material Earrings",
        [14] = "Resupplying Containers",
        [15] = "Thick Fiberboard",
        [16] = "High-quality Insulation Materials",
        [17] = "Heat-resistant Resin",
        [18] = "Long-term Storage Paper",
        [19] = "Habitation Module Chairs",
        [20] = "Test Material Gathering Tools",
        [21] = "High-quality Rest Beds",
        [22] = "A-1: High-durability Fiberboard",
        [23] = "A-1: High-grade Paper",
        [24] = "A-1: Starship Insulation",
        [25] = "A-1: High Burn Charcoal",
        [26] = "A-1: Lunar Flora Test Processing",
        [27] = "A-2: Test Material Final Processing",
        [28] = "A-2: Serving Trays",
        [29] = "A-2: Bunk Beds",
        [30] = "A-2: Work Support Equipment",
        [31] = "A-3: High-quality Crafting Tools",
        [32] = "A-3: Elevating Platforms",
        [33] = "A-1: Power Transmission Shafts I",
        [34] = "A-2: Power Transmission Shafts II",
        [35] = "A-1: Specialized Materials I",
        [36] = "A-2: Specialized Materials II",
        [37] = "A-3: Research Water Tank",
        [38] = "A-2: Rest Facility Materials",
        [39] = "A-3: Rest Facility Furnishings",
        [40] = "A-1: Packing Materials I",
        [41] = "A-2: Packing Materials II",
        [42] = "A-3: Rover Packing Materials",
        [43] = "A-3: Biofuel I",
        [44] = "A-3: Biofuel II",
        [45] = "A-3: Biofuel III",
        [46] = "Multi-purpose Plating",
        [47] = "Spare Starship Parts",
        [48] = "Alloy Inspection",
        [49] = "Custom Parts (Simple)",
        [50] = "Multi-purpose Metal Components",
        [51] = "Mass-produced Necessities",
        [52] = "Standardized Heavy Plating",
        [53] = "Starship Shafts",
        [54] = "Worker's Mining Tools",
        [55] = "Standardized Alloy Rivets",
        [56] = "Worker's Carpentry Tools",
        [57] = "Custom Parts (Intermediate)",
        [58] = "Insulated Equipment",
        [59] = "Rover Shafts",
        [60] = "Standardized Light Plating",
        [61] = "Worker's Smithing Tools",
        [62] = "Bathing Fixtures",
        [63] = "Ceruleum Stoves",
        [64] = "Habitation Lighting",
        [65] = "Lunar Material Tool Processing",
        [66] = "Lunar Material Part Processing",
        [67] = "A-1: Key Facility Plating",
        [68] = "A-1: Rare Material Processing",
        [69] = "A-1: Construction Necessities",
        [70] = "A-1: Worker's Sheet Metal Tools",
        [71] = "A-1: Meteoric Material Test Processing",
        [72] = "A-2: Replica Far Eastern Furnishings",
        [73] = "A-2: Fine-grade Material Processing",
        [74] = "A-2: Moongate Hub Equipment",
        [75] = "A-2: Work Support Equipment",
        [76] = "A-3: High-durability Material Processing",
        [77] = "A-3: Impact-resistant Material Processing",
        [78] = "A-1: Hub Furnishings and Fixtures I",
        [79] = "A-2: Hub Furnishings and Fixtures II",
        [80] = "A-1: Specialized Materials I",
        [81] = "A-2: Specialized Materials II",
        [82] = "A-3: Research Water Tank",
        [83] = "A-2: Starship Building Materials",
        [84] = "A-3: Starship Building Material Processing",
        [85] = "A-1: High-performance Drone Materials I",
        [86] = "A-2: High-performance Drone Materials II",
        [87] = "A-3: High-performance Drones",
        [88] = "A-3: Cosmotized Equipment Materials I",
        [89] = "A-3: Cosmotized Equipment Materials II",
        [90] = "A-3: Cosmotized Equipment Materials III",
        [91] = "Multi-purpose Plating",
        [92] = "Spare Starship Parts",
        [93] = "Alloy Inspection",
        [94] = "Custom Parts (Simple)",
        [95] = "Multi-purpose Metal Components",
        [96] = "Mass-produced Necessities",
        [97] = "Standardized Heavy Plating",
        [98] = "Starship Shafts",
        [99] = "Worker's Culinary Tools I",
        [100] = "Standardized Chainmail Sheets",
        [101] = "Dust-filtering Equipment",
        [102] = "Custom Parts (Intermediate)",
        [103] = "Insulated Equipment",
        [104] = "Rover Parts",
        [105] = "Standardized Light Plating",
        [106] = "Worker's Culinary Tools II",
        [107] = "Beverage Stations",
        [108] = "Campfire Fixtures",
        [109] = "Habitation Storage",
        [110] = "Lunar Material Tool Processing",
        [111] = "Lunar Material Part Processing",
        [112] = "A-1: Key Facility Plating",
        [113] = "A-1: Rare Material Processing",
        [114] = "A-1: Construction Necessities",
        [115] = "A-1: High-conductivity Culinary Tools",
        [116] = "A-1: Meteoric Material Test Processing",
        [117] = "A-2: Replica Incensories",
        [118] = "A-2: Fine-grade Material Processing",
        [119] = "A-2: Moongate Hub Equipment",
        [120] = "A-2: Workspace Lighting",
        [121] = "A-3: High-durability Material Processing",
        [122] = "A-3: Impact-resistant Material Processing",
        [123] = "A-1: Hub Furnishings and Fixtures I",
        [124] = "A-2: Hub Furnishings and Fixtures II",
        [125] = "A-1: Specialized Materials I",
        [126] = "A-2: Specialized Materials II",
        [127] = "A-3: Priority Sample Storage",
        [128] = "A-2: Starship Building Materials",
        [129] = "A-3: Starship Building Material Processing",
        [130] = "A-1: High-performance Drone Materials I",
        [131] = "A-2: High-performance Drone Materials II",
        [132] = "A-3: High-performance Drones",
        [133] = "A-3: Cosmotized Equipment Materials I",
        [134] = "A-3: Cosmotized Equipment Materials II",
        [135] = "A-3: Cosmotized Equipment Materials III",
        [136] = "Multi-purpose Plating",
        [137] = "Spare Starship Parts",
        [138] = "Alloy Inspection",
        [139] = "Custom Parts (Simple)",
        [140] = "Multi-purpose Metal Components",
        [141] = "Mass-produced Necessities",
        [142] = "Standardized Heavy Plating",
        [143] = "Starship Shafts",
        [144] = "Worker's Grinding Tools",
        [145] = "Standardized Chainmail Sheets",
        [146] = "Eye Protection Equipment",
        [147] = "Custom Parts (Intermediate)",
        [148] = "Heat Dissipation Equipment",
        [149] = "Rover Parts",
        [150] = "Standardized Light Plating",
        [151] = "Worker's Weaving Tools",
        [152] = "Observation Devices",
        [153] = "Fireplace Fixtures",
        [154] = "Habitation Vanities",
        [155] = "Lunar Material Tool Processing",
        [156] = "Lunar Material Part Processing",
        [157] = "A-1: Key Facility Plating",
        [158] = "A-1: Rare Material Processing",
        [159] = "A-1: Construction Necessities",
        [160] = "A-1: Fine-grade Knives",
        [161] = "A-1: Meteoric Material Test Processing",
        [162] = "A-2: Replica Bathing Fixtures",
        [163] = "A-2: Fine-grade Material Processing",
        [164] = "A-2: Moongate Hub Equipment",
        [165] = "A-2: Work Support Mechanical Arms",
        [166] = "A-3: High-durability Material Processing",
        [167] = "A-3: Impact-resistant Material Processing",
        [168] = "A-1: Hub Furnishings and Fixtures I",
        [169] = "A-2: Hub Furnishings and Fixtures II",
        [170] = "A-1: Specialized Materials I",
        [171] = "A-2: Specialized Materials II",
        [172] = "A-3: Vending Machines",
        [173] = "A-2: Starship Building Materials",
        [174] = "A-3: Starship Building Material Processing",
        [175] = "A-1: High-performance Drone Materials I",
        [176] = "A-2: High-performance Drone Materials II",
        [177] = "A-3: High-performance Drones",
        [178] = "A-3: Cosmotized Equipment Materials I",
        [179] = "A-3: Cosmotized Equipment Materials II",
        [180] = "A-3: Cosmotized Equipment Materials III",
        [181] = "Multi-purpose Leather Straps",
        [182] = "First-aid Leather",
        [183] = "Gatherer's Gloves",
        [184] = "Essential Research Materials",
        [185] = "Work Pouches",
        [186] = "Leather Room Shoes",
        [187] = "Heat-resistant Leather String",
        [188] = "Worker's Bags",
        [189] = "Worker's Belts",
        [190] = "High-grade Paper",
        [191] = "Sheep Rugs",
        [192] = "Cosmoliner Materials",
        [193] = "New Material Jackets",
        [194] = "Leather First-aid Bags",
        [195] = "Sterile Leather String",
        [196] = "High-grade Rugs",
        [197] = "Transport Leather",
        [198] = "Long-term Storage Paper",
        [199] = "High-grade Rest Chairs",
        [200] = "Test Material Gloves",
        [201] = "High-grade Rest Lounges",
        [202] = "A-1: High-durability Leather String",
        [203] = "A-1: High-grade Paper",
        [204] = "A-1: Research Plant Rug",
        [205] = "A-1: Thermal Leather",
        [206] = "A-1: Lunar Flora Test Processing",
        [207] = "A-2: Test Material Final Processing",
        [208] = "A-2: Work Pouches",
        [209] = "A-2: High-grade Sofas",
        [210] = "A-2: Familiar Furnishings",
        [211] = "A-3: Safety Shoes",
        [212] = "A-3: Gatherer's Overalls",
        [213] = "A-1: Base Supplies I",
        [214] = "A-2: Base Supplies II",
        [215] = "A-1: Specialized Materials I",
        [216] = "A-2: Specialized Materials II",
        [217] = "A-3: Large Research Materials",
        [218] = "A-2: Rest Facility Materials",
        [219] = "A-3: Rest Facility Furnishings",
        [220] = "A-1: Packing Materials I",
        [221] = "A-2: Packing Materials II",
        [222] = "A-3: Rover Packing Materials",
        [223] = "A-3: Cosmic Suits I",
        [224] = "A-3: Cosmic Suits II",
        [225] = "A-3: Cosmic Suits III",
        [226] = "Multi-purpose Yarn",
        [227] = "First-aid Cloth",
        [228] = "Gatherer's Helmets",
        [229] = "Essential Research Materials",
        [230] = "Multi-purpose String",
        [231] = "Divider Curtains",
        [232] = "Heat-resistant Yarn",
        [233] = "Room Garments",
        [234] = "Multi-purpose Fabric",
        [235] = "Composite Fiber",
        [236] = "Infirmary Curtains",
        [237] = "Cosmoliner Materials",
        [238] = "New Material Trousers",
        [239] = "Work Rope",
        [240] = "Sterile Yarn",
        [241] = "High-grade Curtains",
        [242] = "Transport Yarn",
        [243] = "Heat-resistant Composite Fiber",
        [244] = "Rest Supplies",
        [245] = "Test Material Hats",
        [246] = "Rest Cushions",
        [247] = "A-1: High-durability Yarn",
        [248] = "A-1: High-grade Composite Fiber",
        [249] = "A-1: High-grade Bedroom Curtains",
        [250] = "A-1: First-aid Bandaging",
        [251] = "A-1: Lunar Flora Test Processing",
        [252] = "A-2: Test Material Final Processing",
        [253] = "A-2: Weaving Materials",
        [254] = "A-2: Rest Cushions",
        [255] = "A-2: Familiar Furnishings",
        [256] = "A-3: Cold-weather Work Hats",
        [257] = "A-3: Crafter's Overalls",
        [258] = "A-1: Cosmoliner Materials I",
        [259] = "A-2: Cosmoliner Materials II",
        [260] = "A-1: Specialized Materials I",
        [261] = "A-2: Specialized Materials II",
        [262] = "A-3: Large Research Materials",
        [263] = "A-2: Rest Facility Materials",
        [264] = "A-3: Rest Facility Furnishings",
        [265] = "A-1: Packing Materials I",
        [266] = "A-2: Packing Materials II",
        [267] = "A-3: Rover Packing Materials",
        [268] = "A-3: Crew Suits I",
        [269] = "A-3: Crew Suits II",
        [270] = "A-3: Crew Suits III",
        [271] = "Foundation Bricks",
        [272] = "Spice Processing",
        [273] = "Building Adhesive",
        [274] = "Nutrient Supplements",
        [275] = "Aquatic Adhesive",
        [276] = "Medicated Feed Research",
        [277] = "Heat-resistant Bricks",
        [278] = "Health Drinks",
        [279] = "Construction Paint",
        [280] = "Traditional Veneer",
        [281] = "Night Lighting",
        [282] = "Emergency Foodstuffs Development",
        [283] = "Experimental Potables",
        [284] = "Lunar Spice Processing",
        [285] = "Water-resistant Bricks",
        [286] = "Research Medicine",
        [287] = "Holy Water",
        [288] = "Lunar Flooring",
        [289] = "Stellar Nutrients",
        [290] = "Miniature Gardens",
        [291] = "Decorative Lunar Plants",
        [292] = "A-1: Water-resistant Bricks",
        [293] = "A-1: Stellar Adhesive",
        [294] = "A-1: Nutrient Supplements",
        [295] = "A-1: Cafeteria Goods",
        [296] = "A-1: Lunar Seafood Processing",
        [297] = "A-2: Emergency Potables",
        [298] = "A-2: Cosmetic Research Materials",
        [299] = "A-2: Replica Ornamental Plants",
        [300] = "A-2: Artisan's Mixtures",
        [301] = "A-3: Rust Repellent",
        [302] = "A-3: Stable Medicine",
        [303] = "A-1: Natural Remedy Inspection I",
        [304] = "A-2: Natural Remedy Inspection II",
        [305] = "A-1: Loporrit Habitat Improvements I",
        [306] = "A-2: Loporrit Habitat Improvements II",
        [307] = "A-3: Loporrit Habitat Improvements III",
        [308] = "A-2: Aquaculture Feed I",
        [309] = "A-3: Aquaculture Feed II",
        [310] = "A-1: Nutrient Jelly Materials I",
        [311] = "A-2: Nutrient Jelly Materials II",
        [312] = "A-3: Nutrient Jelly",
        [313] = "A-3: Dichromatic Compound I",
        [314] = "A-3: Dichromatic Compound II",
        [315] = "A-3: Dichromatic Compound III",
        [316] = "Standard Lubricant",
        [317] = "Spice Processing",
        [318] = "Building Adhesive",
        [319] = "Aquatic Nutrient Concentrate",
        [320] = "Aquatic Ink",
        [321] = "Medicated Feed Research",
        [322] = "Heat-resistant Lubricant",
        [323] = "Nutrient-rich Foodstuffs",
        [324] = "Construction Paint",
        [325] = "Portable Foodstuffs",
        [326] = "Nutrient-rich Seafood Processing",
        [327] = "Emergency Foodstuff Development",
        [328] = "Essential Whole Meals",
        [329] = "Experimental Foodstuffs",
        [330] = "Water-resistant Lubricant",
        [331] = "Experimental Potables",
        [332] = "Launch Party Foodstuffs",
        [333] = "Home-cooked Seafood Meal",
        [334] = "Nutrient-rich Lunar Food",
        [335] = "Bakery Inspection",
        [336] = "Mushroom Processing",
        [337] = "A-1: Water-resistant Lubricant",
        [338] = "A-1: Stellar Adhesive",
        [339] = "A-1: Liquid Nutrient Supplements",
        [340] = "A-1: Cafeteria Goods",
        [341] = "A-1: Lunar Seafood Processing",
        [342] = "A-2: Stable Food Mass Production",
        [343] = "A-2: Sharlayan Dish Inspection",
        [344] = "A-2: Simple Field Rations",
        [345] = "A-2: Portable Nutrients",
        [346] = "A-3: Cured Seafood",
        [347] = "A-3: Cured Meat",
        [348] = "A-1: Worker's Banquet Preparation I",
        [349] = "A-2: Worker's Banquet Preparation II",
        [350] = "A-1: Loporrit Dietary Improvement I",
        [351] = "A-2: Loporrit Dietary Improvement II",
        [352] = "A-3: Loporrit Dietary Improvement III",
        [353] = "A-2: Aquaculture Feed I",
        [354] = "A-3: Aquaculture Feed II",
        [355] = "A-1: Nutrient-rich Foodstuffs I",
        [356] = "A-2: Nutrient-rich Foodstuffs II",
        [357] = "A-3: Nutrient-rich Foodstuffs III",
        [358] = "A-3: Whole Meals I",
        [359] = "A-3: Whole Meals II",
        [360] = "A-3: Whole Meals III",
        [361] = "Hub Vicinity Survey",
        [362] = "Northwestern Vicinity Survey",
        [363] = "Productivity Review",
        [364] = "Hydrofication Materials",
        [365] = "Multi-purpose Plating Materials",
        [366] = "Air Filter Materials",
        [367] = "Central Radius Survey",
        [368] = "Metal Processing Materials",
        [369] = "Heavy Plating Materials",
        [370] = "Sustained Productivity Review",
        [371] = "Material Collection Appraisal",
        [372] = "Additional Meteoric Deposits",
        [373] = "Water Filter Materials",
        [374] = "Outer Sector Survey",
        [375] = "Element-resistant Materials",
        [376] = "Light Plating Materials",
        [377] = "Lunar Yellow Copper Ore",
        [378] = "Technique Appraisal",
        [379] = "Energization Materials",
        [380] = "Fine-grade Processing Materials",
        [381] = "Stellar Repair Materials",
        [382] = "A-1: Alloy Processing Materials",
        [383] = "A-1: Crater Extraction",
        [384] = "A-1: Special Plating Materials",
        [385] = "A-1: Lunar Chromite Ore",
        [386] = "A-1: Meteoric Deposits",
        [387] = "A-2: Precise Survey",
        [388] = "A-2: Alchemical Refinement Materials",
        [389] = "A-2: Southwestern Survey",
        [390] = "A-2: Precise Lunar Nadir Survey",
        [391] = "A-3: Rare Material Extraction",
        [392] = "A-3: Supplemental Processing Materials",
        [393] = "A-1: Hub Vicinity Gathering I",
        [394] = "A-2: Hub Vicinity Gathering II",
        [395] = "A-1: High-grade Energization Materials I",
        [396] = "A-2: High-grade Energization Materials II",
        [397] = "A-3: High-grade Energization Materials III",
        [398] = "A-2: Fine-grade Water Filter Materials I",
        [399] = "A-3: Fine-grade Water Filter Materials II",
        [400] = "A-1: Fine-grade Air Filter Materials I",
        [401] = "A-3: Fine-grade Air Filter Materials II",
        [402] = "A-2: Fine-grade Air Filter Materials III",
        [403] = "A-3: Folkloric Materials I",
        [404] = "A-3: Folkloric Materials II",
        [405] = "A-3: Folkloric Materials III",
        [406] = "Hub Vicinity Survey",
        [407] = "Eastern Vicinity Survey",
        [408] = "Productivity Review",
        [409] = "Hydrofication Materials",
        [410] = "Multi-purpose Fiberboard Materials",
        [411] = "Air Filter Materials",
        [412] = "Central Radius Survey",
        [413] = "Processing Fibers",
        [414] = "Thin Fiberboard Materials",
        [415] = "Sustained Productivity Review",
        [416] = "Material Collection Appraisal",
        [417] = "Branch Collection",
        [418] = "Water Filter Materials",
        [419] = "Outer Sector Survey",
        [420] = "Insulation Materials",
        [421] = "Thick Fiberboard Materials",
        [422] = "Blue Fiber Collection Appraisal",
        [423] = "Technique Appraisal",
        [424] = "Energization Materials",
        [425] = "Fine-grade Processing Materials",
        [426] = "Stellar Repair Materials",
        [427] = "A-1: Tanning Agents",
        [428] = "A-1: Experimental Cultivars",
        [429] = "A-1: Fiberboard Materials",
        [430] = "A-1: Fungi Collection",
        [431] = "A-1: Fiber Collection Appraisal",
        [432] = "A-2: Precise Survey",
        [433] = "A-2: Alchemical Refinement Materials",
        [434] = "A-2: Southwestern Survey",
        [435] = "A-2: Precise Lunar Nadir Survey",
        [436] = "A-3: Rare Material Extraction",
        [437] = "A-3: Supplemental Processing Materials",
        [438] = "A-1: Hub Vicinity Gathering I",
        [439] = "A-2: Hub Vicinity Gathering II",
        [440] = "A-1: High-grade Energization Materials I",
        [441] = "A-2: High-grade Energization Materials II",
        [442] = "A-3: High-grade Energization Materials III",
        [443] = "A-2: Fine-grade Water Filter Materials I",
        [444] = "A-3: Fine-grade Water Filter Materials II",
        [445] = "A-1: Fine-grade Air Filter Materials I",
        [446] = "A-3: Fine-grade Air Filter Materials II",
        [447] = "A-2: Fine-grade Air Filter Materials III",
        [448] = "A-3: Folkloric Materials I",
        [449] = "A-3: Folkloric Materials II",
        [450] = "A-3: Folkloric Materials III",
        [451] = "Lunch Emergency",
        [452] = "Large Aquatic Specimens",
        [453] = "Western Water Inspection",
        [454] = "Aquatic Foodstuffs",
        [455] = "Weeping Pool Ecological Survey",
        [456] = "Assorted Alchemical Materials",
        [457] = "Big Fish",
        [458] = "Environmental Inspection",
        [459] = "Polarized Dyes",
        [460] = "Southeast Well Ecological Survey",
        [461] = "Fish Sauce Ingredients",
        [462] = "Aquatic Samples",
        [463] = "Northwestern Water Inspection",
        [464] = "Hollow Harbor Water Inspection",
        [465] = "Preserved Foodstuffs",
        [466] = "Hollow Harbor Ecological Survey",
        [467] = "Absolute Specimen",
        [468] = "Aetherochemical Creatures",
        [469] = "Westward Ecological Survey",
        [470] = "Supper Emergency",
        [471] = "Alchemical Resources",
        [472] = "A-1: Northward Ecological Survey",
        [473] = "A-1: Rare Aquatic Specimens",
        [474] = "A-1: Foodstuff Emergency",
        [475] = "A-1: Precise Water Survey",
        [476] = "A-1: Fine-grade Aquatic Processing Materials",
        [477] = "A-2: Large Aquatic Specimens",
        [478] = "A-2: Assorted Alchemical Materials",
        [479] = "A-2: Aetherial Falls Experiment",
        [480] = "A-2: Foodstuff Emergency",
        [481] = "A-3: Palus Arsenici Ecological Survey",
        [482] = "A-3: Large Aquatic Specimens",
        [483] = "A-1: Aquatic Inspection I",
        [484] = "A-2: Aquatic Inspection II",
        [485] = "A-1: Fine-grade Water Filter Materials I",
        [486] = "A-2: Fine-grade Water Filter Materials II",
        [487] = "A-3: Fine-grade Water Filter Materials III",
        [488] = "A-2: Coexisting Species I",
        [489] = "A-3: Coexisting Species II",
        [490] = "A-1: Aetherochemical Samples I",
        [491] = "A-2: Aetherochemical Samples II",
        [492] = "A-3: Aetherochemical Samples III",
        [493] = "A-3: Unidentified Aquatic Specimens I",
        [494] = "A-3: Unidentified Aquatic Specimens II",
        [495] = "A-3: Unidentified Aquatic Specimens III",
        [496] = "A-2: Aquatic Resource Research Tanks",
        [497] = "A-2: Impact-resistant Containers",
        [498] = "A-2: Soothing Censers",
        [499] = "A-3: Automaton Digging",
        [500] = "A-3: Lunar Leather",
        [501] = "A-3: High-quality Floor Tiling",
        [502] = "A-2: Lunar Tanning Agents",
        [503] = "A-2: Special Spongoi Processing",
        [504] = "A-2: Freshness Preservation",
        [505] = "A-3: Lunar Tools",
        [506] = "A-3: High Burn Furnace",
        [507] = "A-3: Mushroom-borne Comfort",
        [508] = "A-2: Processed Aquatic Metals",
        [509] = "A-2: Refined Moon Gel",
        [510] = "A-3: Crystallic Gems",
        [511] = "A-3: Eel Rations"
    }
}

function CosmicExploration:new(ferret)
    o = {}
    setmetatable(o, self)
    self.__index = self
    self.ferret = ferret
    return o
end

function CosmicExploration:is_main_ui_visible() return IsAddonVisible("WKSHud") end

function CosmicExploration:wait_for_main_ui_to_be_visible()
    self.ferret:wait_until(function() return self:is_main_ui_visible() end);
end

function CosmicExploration:start_craft()
    if IsAddonVisible("WKSRecipeNotebook") then
        yield("/callback WKSRecipeNotebook true 6")
    end
end

function CosmicExploration:get_craftable_item_count() end

function CosmicExploration:open_mission_ui()
    if IsAddonVisible("WKSHud") then
        if not IsAddonVisible("WKSMission") then
            yield("/callback WKSHud true 11")
            self.ferret:wait_for_addon("WKSMission")
        end
    end
end

function CosmicExploration:open_basic_mission_ui()
    if IsAddonVisible("WKSHud") then
        self:open_mission_ui()
        yield("/callback WKSMission true 15 0")
    end
end

function CosmicExploration:open_critical_mission_ui()
    if IsAddonVisible("WKSHud") then
        self:open_mission_ui()
        yield("/callback WKSMission true 15 1")
    end
end

function CosmicExploration:open_provisional_mission_ui()
    if IsAddonVisible("WKSHud") then
        self:open_mission_ui()
        yield("/callback WKSMission true 15 1")
    end
end

function CosmicExploration:get_available_missions()
    local missions = {}
    local index = 2 -- Start at 2 because that's the first mission node
    repeat
        local mission = GetNodeText("WKSMission", 89, index, 8)
        if mission ~= "" then table.insert(missions, mission) end
        index = index + 1
    until (mission == "")

    return missions;
end

function CosmicExploration:is_mission_available(mission)
    local available_missions = self:get_available_missions()
    for _, available_mission in ipairs(available_missions) do
        if string.find(available_mission, mission) then return true end
    end

    return false
end

function CosmicExploration:get_mission_id_from_name(name)
    for id, mission in pairs(self.mission_ids) do
        if mission == name then return id end
    end

    return 1
end

function CosmicExploration:start_mission(mission)
    self:start_mission_by_id(self:get_mission_id_from_name(mission))
end

function CosmicExploration:start_mission_by_id(id)
    self:open_basic_mission_ui()
    self.ferret:wait_for_addon("WKSMission")
    self.ferret.logger:debug("/callback WKSMission true 13 " .. id)
    yield("/callback WKSMission true 13 " .. id)
end

function CosmicExploration:report_mission()
    if not IsAddonVisible("WKSMissionInfomation") then
        yield("/callback WKSHud true 11")
        self.ferret:wait_for_addon("WKSMissionInfomation")
    end

    yield("/callback WKSMissionInfomation true 11")
end

function CosmicExploration:abandon_mission()
    if not IsAddonVisible("WKSMissionInfomation") then
        yield("/callback WKSHud true 11")
        self.ferret:wait_for_addon("WKSMissionInfomation")
    end

    yield("/callback WKSMissionInfomation true 12")
end

-- Get's the first mission available
function CosmicExploration:get_first_available_mission()
    for id, name in pairs(self.mission_ids) do
        if self:is_mission_available(name) then return id end
    end

    return nil
end

function CosmicExploration:refresh_missions()
    local id = self:get_first_available_mission()
    if id == nil then return false end

    self:start_mission_by_id(id)
    self.ferret:wait(1)
    self.ferret.logger:debug('Waiting for mission to start')
    self.ferret.chat:wait_for_message('The stellar mission “')
    self.ferret.chat:send_marker()

    self:abandon_mission()
    self.ferret:wait(4)
    return true
end
